# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘              SHIPWRIGHT â€” TMUX OVERLAY CONFIGURATION                       â•‘
# â•‘                                                                            â•‘
# â•‘  This overlay adds agent-aware pane styling and team keybindings to        â•‘
# â•‘  your existing tmux config. It is sourced automatically by tmux.conf       â•‘
# â•‘  but can also be used independently:                                       â•‘
# â•‘                                                                            â•‘
# â•‘    tmux source-file ~/.tmux/shipwright-overlay.conf                        â•‘
# â•‘                                                                            â•‘
# â•‘  What this overlay does:                                                   â•‘
# â•‘    - Shows agent names in pane borders (pane_title)                        â•‘
# â•‘    - Enables aggressive resize for better multi-agent layouts              â•‘
# â•‘    - Adds safety bindings to prevent accidentally killing agent panes      â•‘
# â•‘    - Provides team-specific keybindings for navigation and management      â•‘
# â•‘    - Fixes known Claude Code + tmux compatibility issues                   â•‘
# â•‘                                                                            â•‘
# â•‘  Convention: Each Claude agent pane should set its title on startup via:   â•‘
# â•‘    printf '\033]2;agent-name\033\\'                                        â•‘
# â•‘  The shipwright CLI does this automatically when spawning agent panes.     â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PANE TITLES â€” Show agent names in borders
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Display pane titles at the top of each pane border
set -g pane-border-status top

# Format: pane index, agent name, running command, zoom indicator
# Active pane gets cyan accent; inactive stays muted
# Uses #{pane_title} which each agent sets via OSC 2 escape sequence
set -g pane-border-format "#{?pane_active,#[fg=#00d4ff]#[bold],#[fg=#71717a]} #P â”‚ #{pane_title} #[fg=#333355]â”‚#[default] #{?pane_active,#[fg=#e4e4e7],#[fg=#52525b]}#{pane_current_command} #{?window_zoomed_flag,#[fg=#facc15]#[bold]ğŸ” ZOOMED ,}"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# LAYOUT â€” Optimize for multi-agent pane layouts
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Aggressive resize: let panes resize independently per client
# This prevents smaller terminal clients from constraining team pane sizes
setw -g aggressive-resize on

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# DARK THEME DEFAULTS â€” Ensure all panes get the dark background
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# These session-level styles apply to ALL panes, even those created by
# external tools (Claude Code agent spawning, scripts, etc.)
set -g window-style 'bg=#1a1a2e,fg=#e4e4e7'
set -g window-active-style 'bg=#1a1a2e,fg=#e4e4e7'

# Hooks provide belt-and-suspenders coverage: explicitly set per-pane
# colors whenever a pane is created, preventing white flash on creation.
# Also re-enable allow-passthrough per-pane (some tmux versions reset it).
set-hook -g after-split-window "select-pane -P 'bg=#1a1a2e,fg=#e4e4e7'"
set-hook -g after-new-window   "select-pane -P 'bg=#1a1a2e,fg=#e4e4e7'"
set-hook -g after-new-session  "select-pane -P 'bg=#1a1a2e,fg=#e4e4e7'"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SAFETY â€” Confirm before killing agent panes
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Override default kill-pane to require confirmation in team windows
# This prevents accidentally terminating a running Claude agent
bind x confirm-before -p "Kill pane #{pane_title}? (y/n)" kill-pane
bind X confirm-before -p "Kill ALL panes in window #W? (y/n)" kill-window

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# TEAM NAVIGATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# prefix + g â†’ display pane numbers for 5 seconds (type number to select)
bind g display-panes -d 5000

# prefix + G â†’ toggle zoom on current agent pane (focus on one agent's output)
bind G resize-pane -Z

# prefix + w â†’ choose window/pane from a tree (visual picker)
bind w choose-tree -Zw

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# TEAM MANAGEMENT
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# prefix + M-t â†’ send the same command to all panes (synchronized input)
# Useful for stopping all agents at once, etc.
bind M-t setw synchronize-panes \; display-message "Team sync #{?synchronize-panes,ON,OFF}"

# prefix + M-l â†’ rotate through even-horizontal, even-vertical, tiled layouts
bind M-l next-layout

# prefix + M-s â†’ capture current pane's full scrollback to file
bind M-s run-shell "tmux capture-pane -pS - > /tmp/claude-pane-#{pane_title}-$(date +%s).txt && tmux display-message 'Captured #{pane_title} to /tmp/'"

# prefix + M-a â†’ capture ALL panes in current window (full scrollback each)
bind M-a run-shell "\
  for pane_id in $(tmux list-panes -F '##{pane_id}'); do \
    title=$(tmux display-message -t \$pane_id -p '##{pane_title}'); \
    tmux capture-pane -t \$pane_id -pS - > /tmp/claude-pane-\${title:-\$pane_id}-$(date +%s).txt; \
  done && tmux display-message 'Captured all panes to /tmp/'"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# LAYOUT PRESETS â€” Quick-switch pane arrangements
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# prefix + M-1 â†’ main-horizontal: leader (left 65%) | agents stacked (right 35%)
# prefix + M-2 â†’ main-vertical: leader (top 60%) | agents tiled (bottom 40%)
# prefix + M-3 â†’ tiled (equal sizes)
bind M-1 select-layout main-horizontal \; resize-pane -t 0 -x 65%
bind M-2 select-layout main-vertical \; resize-pane -t 0 -y 60%
bind M-3 select-layout tiled

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SHIPWRIGHT POPUPS â€” Quick access to tools
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# prefix + M-d â†’ Shipwright dashboard in floating popup
bind M-d display-popup -w 85% -h 80% -E "shipwright status 2>/dev/null; echo ''; shipwright ps 2>/dev/null; echo ''; echo 'Press ENTER to close'; read"

# prefix + M-m â†’ Memory system in floating popup
bind M-m display-popup -w 80% -h 70% -E "shipwright memory show 2>/dev/null || echo 'No memories found'; echo ''; echo 'Press ENTER to close'; read"

# prefix + M-h â†’ Heartbeat status in floating popup
bind M-h display-popup -w 70% -h 50% -E "shipwright heartbeat list 2>/dev/null || echo 'No active heartbeats'; echo ''; echo 'Press ENTER to close'; read"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PANE REAPER â€” Quick cleanup of dead agent panes
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# prefix + R â€” Run one-shot reaper (clean dead agent panes)
bind R run-shell "shipwright reaper 2>/dev/null; tmux display-message 'Reaper: cleaned dead agent panes'"
